<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Tue Apr 24 11:45:35 2018 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>make_plots.pro (Documentation for /Users/penton/Dropbox/LASP/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="make_plots.pro (Documentation for /Users/penton/Dropbox/LASP/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;+</span>
<span class="comments">;	NAME: make_plots</span>
<span class="comments">;</span>
<span class="comments">;	USAGE: make_plots,[add_allcorrs=add_allcorrs]</span>
<span class="comments">;</span>
<span class="comments">;	OPTIONAL INPUT PARAMETERS:</span>
<span class="comments">;</span>
<span class="comments">;	ADD_ALLCORRS: Set to turn on DIST, DOPP, and DARKCORR (default=0)</span>
<span class="comments">;-</span>
<a id="make_plots:source"></a>pro make_plots,add_allcorrs=add_allcorrs
	if n_elements(add_allcorrs) ne 1 then add_allcorrs=0

	s_ex=(add_allcorrs ? '_dddcorr' : '')
	s_tit=(add_allcorrs ? ' (w/ DDDcorr)' : '')
	<span class="comments">;</span>
	<span class="comments">; First just plot the UpScan, DownScan and ReF</span>
	<span class="comments">;</span>
	FF='(F8.3)'
	close_gwin
	pngdir=get_laspdir(/png)
	txtdir=get_laspdir(/txt)
		DownScan=[9.434134508500002E14, 9.434178736700002E14]
		UpScan=[9.434251237500002E14, 9.434295278700002E14]
		up_color=get_up_color()
		dn_color=get_dn_color()
		rf_color=get_ref_color()
		zwb=get_waveband()
		dwb=get_default_waveband()
		DS_telem=get_telem(DownScan,add_doppcorr=0,add_distcorr=0,add_darkcorr=0)
		US_telem=get_telem(UpScan,add_doppcorr=0,add_distcorr=0,add_darkcorr=0)
		DS_telem_ddd=get_telem(DownScan,add_doppcorr=1,add_distcorr=1,add_darkcorr=1)
		US_telem_ddd=get_telem(UpScan,add_doppcorr=1,add_distcorr=1,add_darkcorr=1)

		DS_telem=(add_allcorrs ? DS_telem_ddd : DS_telem)
		US_telem=(add_allcorrs ? US_telem_ddd : US_telem)
		refspec=get_refspec(do_plot=do_plot)
		scale=1.0
		wDS=plot(DS_telem.waves,DS_telem.irr,name='Down Scan',color=up_color,thick=3,xtitle='Wavelength (nm)',$
			ytitle='Irradiance (W/m$^2$)',$
			dimensions=[800,800],font_name='Times',font_size=14,xrange=dwb,$
			title='UpScan vs DownScan'+s_tit)
		wUS=plot(US_telem.waves,US_telem.irr+0.001,name='Up Scan + 0.001',color=dn_color,/overplot,thick=2)
		rp=plot(refspec.WAVE_NM,refspec.irr,/overplot,color=rf_color,name='Reference',thick=2)
		l=legend(font_name=Times,font_size=12,shadow=0,linestyle=6,position=[0.4,0.8],/normal)

		wDS.save,pngdir+'UpDn'+s_ex+'.png'
		wDSz=plot(DS_telem.waves,DS_telem.irr,name='Down Scan',color=up_color,thick=3,xtitle='Wavelength (nm)',$
			ytitle='Irradiance (W/m$^2$)',$
			dimensions=[800,800],font_name='Times',font_size=14,xrange=dwb,$
			title='UpScan vs DownScan'+s_tit)
		wUSz=plot(US_telem.waves,US_telem.irr,name='Up Scan',color=dn_color,/overplot,thick=2)
		rp=plot(refspec.WAVE_NM,refspec.irr,/overplot,color=rf_color,name='REFERENCE',thick=2)
		l=legend(font_name=Times,font_size=12,shadow=0,linestyle=6,position=[0.4,0.8],/normal)
		<span class="comments">;</span>
		<span class="comments">; interpolate onto reference spectrum scale and plot</span>
		<span class="comments">;</span>
		rwaves=refspec.WAVE_NM
		dflux=interpol(DS_telem.irr,DS_telem.waves,rwaves)
		uflux=interpol(US_telem.irr,US_telem.waves,rwaves)
		findex=where((rwaves ge dwb[0]) and (rwaves le dwb[1]),ct)
		rfwave=rwaves[findex]
		udf=uflux[findex]/dflux[findex]
		<span class="comments">;</span>
		index=where((rwaves ge zwb[0]) and (rwaves le zwb[1]),ct)
		rw=rwaves[index]
		rf=refspec.irr[index]
		uf=uflux[index]
		df=dflux[index]
		ud=uf/df
		rindex=where((rw ge 181.1) and (rw le 181.4),ct)
		rflux=rf[rindex]
		rmed_flux=median(rflux)

		cross_correlate,uf,df,udoffset,corr
		cross_correlate,uf,rf,uroffset,corr
		cross_correlate,df,rf,droffset,corr
		help,udoffset,uroffset,droffset

		sudoffset=udoffset*(rw[2]-rw[1])
		suroffset=uroffset*(rw[2]-rw[1])
		sdroffset=droffset*(rw[2]-rw[1])
		help,sudoffset,suroffset,sdroffset

		wUSz.title='UpScan vs DownScan: Shift is '+string1f(sudoffset,format=FF)+' nm'+s_tit
		l=legend(font_name=Times,font_size=12,shadow=0,linestyle=6,position=[0.4,0.8],/normal)
		wUSz.xrange=zwb
		wUSz.save,pngdir+'UpDn_Zoom'+s_ex+'.png'
		rS=plot(rfwave,udf,name='UP_DOWN_ratio',thick=3,xtitle='Wavelength (nm)',ytitle='UpScan/DownScan',$
			dimensions=[800,800],font_name='Times',font_size=14,xrange=dwb,$
			color='BLUE')
		rS.title='Ratio of UpScan/DownScan: Shift is '+string1f(sudoffset,format=FF)+' nm'+s_tit
		rS.save,pngdir+'UD'+s_ex+'.png'
		rS.xrange=zwb
		rp=plot(refspec.WAVE_NM,refspec.irr/rmed_flux,/overplot,color=rf_color,name='Reference',thick=2)
		l=legend(font_name=Times,font_size=12,shadow=0,linestyle=6,position=[0.5,0.8],/normal)
		rs.save,pngdir+'UD_Zoom'+s_ex+'.png'
		<span class="comments">;</span>
end
</code>
    </div>
  </body>
</html>